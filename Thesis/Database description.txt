В базе три схемы: справочная (References), несущая основную OLTP-нагрузку схема "Накладные" (Invoices) и History - схема, на основе которой построен куб.
В справочных таблицах лежат списки возможных кладовок (Storerooms), состояний накладной (States) и результатов доставки (Delivery results), которые будет вводить курьер.
Кладовки три: доставка, возврат и прозвон (колл-центр). Состояния бывают "на кладовке" - на любой из них, то есть физически на сортировочном центре, "выдана курьеру" и "доставлена" - возможны у накладных с кладовкой "доставка", "возврат" - возможно у накладных с кладовкой "возврат", это состояние будет устанавливаться при доставке соответствующей возвратной накладной.
Первичные и возвратные накладные находятся в одной таблице, имеется признак is_return.
На таблицу Invoices установлен триггер, который при обновлении столбца текущей даты доставки пишет в таблицу History.Delivery_history дату доставки и результат доставки в неё. В схеме History есть также таблица History.Dates, в которую вставляются текущие даты с некоторым запасом вперёд - на которые может назначаться доставка.
По умолчанию каждая накладная имеет завтрашнюю дату доставки и находится на кладовке "доставка" (delivery, storeroom_id=1). В качестве даты создания накладной (Creation date) будет устанавливаться GETDATE() при каждом INSERT'e. Внешние ключи "текущая кладовка", "текущее состояние", "последнй результат доставки" ссылаются на таблицы схемы references.
Я создала две циклических последовательности для номеров (столбец Invoice каждой таблицы схемы Invoices) первичных накладных (11-значные на 150-) и возвратных (10-значные на 40-). Подразумевается, что накладных в конечных состояниях постепенно будут убираться в архив, и ID будут освобождаться.
В схеме Invoices пять хранимых процедур. 
Выдача курьеру - всем накладным на кладовке "доставка" приписывается состояние "выдан курьеру".
Скрипт курьера - курьер может ввести накладным, находящимся у него на руках, пять возможных результатов доставки.
Скрипт оператора колл-центра - он перебирает все накладные на кладовке колл-центра, но работать может с любыми накладными. Он может ввести либо отказ, либо перенос на последующую дату.
Инвентаризация - её проходят все накладные, находящиеся на какой-либо кладовке. Накладные с завтрашней датой доставки кладутся на кладовку "доставка", с последним результатом 2 "отказ" или истекшим сроком хранения - на "возврат", остальные - в "колл-центр".
Создание возвратных накладных - находящимся "на кладовке" "возврат" накладным устанавливается конечное состояние "возврат", а в таблицу "Invoices" вставляется возвратная накладная с первым свободным номером, который вставляется и в колонку return_invoice для нашей первичной накладной.
Для куба таблицей фактов служит таблица History.Delivery_history, а измерениями - History.Dates, Reference.Delivery_results и Reference.Clients.