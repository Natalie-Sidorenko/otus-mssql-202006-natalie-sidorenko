В базе две схемы: справочная (References) и основная рабочая "Накладные" (Invoices).
В справочных таблицах лежат списки возможных кладовок (Storerooms), состояний накладной (States) и результатов доставки (Delivery results), которые будет вводить курьер.
Кладовки три: доставка, возврат и прозвон (колл-центр). Состояния бывают "на кладовке" - на любой из них, то есть физически на сортировочном центре, "выдана курьеру" и "доставлена" - возможны у накладных с кладовкой "доставка", "возврат" - возможно у накладных с кладовкой "возврат", это состояние будет устанавливаться при доставке соответствующей возвратной накладной. Какие состояния возможны у какой кладовки - будет реализовано не здесь (не в рамках ограничений на таблицы).
В рабочей схеме две таблицы - первичных и возвратных накладных. Они ссылаются номерами друг на друга.
По умолчанию каждая накладная имеет завтрашнюю дату доставки и находится на кладовке "доставка" (delivery, id_sr=1). В качестве даты создания накладной (Creation date) будет устанавливаться GETDATE() при каждом INSERT'e. Внешние ключи "текущая кладовка", "текущее состояние", "последнй результат доставки" ссылаются на таблицы схемы references.
Я создала две циклических последовательности для номеров (столбец Invoice каждой таблицы схемы Invoices) первичных накладных (11-значные на 150-) и возвратных (10-значные на 40-). Подразумевается, что накладных в конечных состояниях постепенно будут убираться в архив, и ID будут освобождаться.