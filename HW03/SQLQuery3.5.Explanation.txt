Запрос выбирает накладные (invoices) стоимостью выше 27000 и выводит по ним их ID, дату, сотрудника-продажника, стоимость накладной и стоимость фактически забранных составляющих заказа (order) по этой накладной.
Я переписала всё через JOIN'ы в том числе с двумя CTE. В статистике с одной стороны уменьшились цифры чтений и сканирований по таблицам базы WWI, с другой стороны увеличились по таблице Worktable (что это за таблица? CTE?)
Отличия в планах, которые увидела я, это что у меня меньше операций вычисления скаляра (4 против 6 в изначальном запросе) и нет параллелизма. Прилагаю планы в виде файлов .sqlplan, а также статистики в txt.